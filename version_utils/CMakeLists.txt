macro(create_version)
   set(options WITH_GIT)
   set(oneValueArgs MAJOR MINOR PATCH SUFF)
   set(multiValueArgs)
   cmake_parse_arguments(VER "${options}" "${oneValueArgs}" "${multiValueArgs}" "${ARGN}")

   set(PROJ ${CMAKE_PROJECT_NAME})

   if(VER_MAJOR)
      set(${PROJ}_VERSION_MAJOR ${VER_MAJOR})
   else()
      set(${PROJ}_VERSION_MAJOR "0")
   endif()
   if(VER_MINOR)
      set(${PROJ}_VERSION_MINOR ${VER_MINOR})
   else()
      set(${PROJ}_VERSION_MINOR "0")
   endif()
   if(VER_PATCH)
      set(${PROJ}_VERSION_PATCH ${VER_PATCH})
   else()
      set(${PROJ}_VERSION_PATCH "0")
   endif()

   if(VER_SUFF)
      if(VER_WITH_GIT)
         git_info(
            COMMIT         VCOMMIT
            IS_DIRTY       VID
         )
         if(VID)
            set(${PROJ}_VERSION_TWEAK "${VER_SUFF}-${VCOMMIT}-dirty")
         else()
            set(${PROJ}_VERSION_TWEAK "${VER_SUFF}-${VCOMMIT}")
         endif()
      else()
         set(${PROJ}_VERSION_TWEAK "${VER_SUFF}")
      endif()
   else()
      if(VER_WITH_GIT)
         git_info(
            COMMIT   VCOMMIT
            IS_DIRTY VID
         )
         if(VID)
            set(${PROJ}_VERSION_TWEAK "${VCOMMIT}-dirty")
         else()
            set(${PROJ}_VERSION_TWEAK "${VCOMMIT}")
         endif()
      endif()
   endif()

   if(${PROJ}_VERSION_TWEAK)
      set(${PROJ}_VERSION ${${PROJ}_VERSION_MAJOR}.${${PROJ}_VERSION_MINOR}.${${PROJ}_VERSION_PATCH}-${${PROJ}_VERSION_TWEAK})
   else()
      set(${PROJ}_VERSION ${${PROJ}_VERSION_MAJOR}.${${PROJ}_VERSION_MINOR}.${${PROJ}_VERSION_PATCH})
   endif()
endmacro()

macro(get_version)
   set(options)
   set(oneValueArgs VERSION)
   set(multiValueArgs)
   cmake_parse_arguments(VER "${options}" "${oneValueArgs}" "${multiValueArgs}" "${ARGN}")

   set(${VER_VERSION} ${CMAKE_PROJECT_NAME}_VERSION PARENT_SCOPE)
endmacro()

macro(get_version_components)
   set(options)
   set(oneValueArgs MAJOR MINOR PATCH SUFF)
   set(multiValueArgs)
   cmake_parse_arguments(VER "${options}" "${oneValueArgs}" "${multiValueArgs}" "${ARGN}")

   if(VER_MAJOR)
      set(${VER_MAJOR} ${${PROJ}_VERSION_MAJOR})
   endif()
   if(VER_MINOR)
      set(${VER_MINOR} ${${PROJ}_VERSION_MINOR})
   endif()
   if(VER_PATCH)
      set(${VER_PATCH} ${${PROJ}_VERSION_PATCH})
   endif()
   if(VER_SUFF)
      set(${VER_SUFF} ${${PROJ}_VERSION_TWEAK})
   endif()
endmacro()

